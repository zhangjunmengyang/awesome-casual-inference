# å› æœæ¨æ–­é¢è¯• Cheatsheet - Part 0 åŸºç¡€ç¯‡

> æœ¬ Cheatsheet æ•´ç†è‡ª Part 0 Foundation æ¨¡å—ï¼Œæ”¶å½•"2 åˆ†é’Ÿå®ç°ä¸€ä¸‹ xxx"çš„ç¼–ç¨‹é¢˜å’Œé«˜é¢‘æ ¸å¿ƒæ¦‚å¿µé¢˜ã€‚
>
> **ä½¿ç”¨æ–¹æ³•**ï¼šå…ˆçœ‹é¢˜ç›®æ€è€ƒï¼Œå†å±•å¼€ç­”æ¡ˆå¯¹ç…§ã€‚

---

## ç›®å½•

1. [æ ¸å¿ƒå…¬å¼é€ŸæŸ¥](#æ ¸å¿ƒå…¬å¼é€ŸæŸ¥)
2. [2 åˆ†é’Ÿç¼–ç¨‹é¢˜](#2-åˆ†é’Ÿç¼–ç¨‹é¢˜)
3. [é«˜é¢‘æ¦‚å¿µé¢˜](#é«˜é¢‘æ¦‚å¿µé¢˜)
4. [æ˜“é”™ç‚¹è­¦ç¤º](#æ˜“é”™ç‚¹è­¦ç¤º)

---

## æ ¸å¿ƒå…¬å¼é€ŸæŸ¥

### æ½œåœ¨ç»“æœæ¡†æ¶

| æ¦‚å¿µ | å…¬å¼ | ä¸€å¥è¯è§£é‡Š |
|-----|------|-----------|
| è§‚æµ‹ç»“æœ | $Y = T \cdot Y(1) + (1-T) \cdot Y(0)$ | åªèƒ½çœ‹åˆ°ä¸€ä¸ªæ½œåœ¨ç»“æœ |
| ITE | $\tau_i = Y_i(1) - Y_i(0)$ | ä¸ªä½“å¤„ç†æ•ˆåº”ï¼ˆä¸å¯è§‚æµ‹ï¼‰ |
| ATE | $\tau = E[Y(1) - Y(0)]$ | å¹³å‡å¤„ç†æ•ˆåº” |
| ATT | $\tau_{ATT} = E[Y(1) - Y(0) \| T=1]$ | å¤„ç†ç»„çš„å¹³å‡æ•ˆåº” |

### æ··æ·†åå·®å…¬å¼ (OVB)

$$\text{Bias} = \gamma \times \delta$$

- $\gamma$: æ··æ·†å˜é‡ X å¯¹ç»“æœ Y çš„æ•ˆåº”ï¼ˆæ§åˆ¶ T åï¼‰
- $\delta$: æ··æ·†å˜é‡ X ä¸å¤„ç† T çš„å…³è”

### é€‰æ‹©åå·®åˆ†è§£

$$E[Y|T=1] - E[Y|T=0] = \underbrace{E[Y(1) - Y(0)|T=1]}_{\text{ATT}} + \underbrace{E[Y(0)|T=1] - E[Y(0)|T=0]}_{\text{é€‰æ‹©åå·®}}$$

### åé—¨å‡†åˆ™

å˜é‡é›†åˆ Z æ»¡è¶³åé—¨å‡†åˆ™ï¼Œéœ€æ»¡è¶³ï¼š
1. Z é˜»æ–­æ‰€æœ‰ä» T åˆ° Y çš„åé—¨è·¯å¾„
2. Z ä¸åŒ…å« T çš„ä»»ä½•åä»£

---

## 2 åˆ†é’Ÿç¼–ç¨‹é¢˜

### é¢˜ç›® 1ï¼šç”Ÿæˆæ½œåœ¨ç»“æœæ•°æ®

> **é¢˜ç›®**ï¼šå®ç°ä¸€ä¸ªå‡½æ•°ï¼Œç”Ÿæˆå¸¦æœ‰æ½œåœ¨ç»“æœçš„æ¨¡æ‹Ÿæ•°æ®ï¼ŒçœŸå® ATE = 10

<details>
<summary>ğŸ’¡ å‚è€ƒç­”æ¡ˆ</summary>

```python
def generate_potential_outcomes(n=1000, seed=42):
    """
    ç”Ÿæˆæ½œåœ¨ç»“æœæ•°æ®
    DGP: Y(0) = 50 + 5X + Îµ, Y(1) = 60 + 5X + Îµ
    çœŸå® ATE = 10
    """
    np.random.seed(seed)

    X = np.random.randn(n)                    # åå˜é‡
    T = np.random.binomial(1, 0.5, n)          # éšæœºåˆ†é…

    Y0 = 50 + 5 * X + np.random.randn(n) * 5  # æ½œåœ¨ç»“æœ Y(0)
    Y1 = 60 + 5 * X + np.random.randn(n) * 5  # æ½œåœ¨ç»“æœ Y(1)

    Y = T * Y1 + (1 - T) * Y0                  # è§‚æµ‹ç»“æœ
    ITE = Y1 - Y0                              # ä¸ªä½“æ•ˆåº”

    return pd.DataFrame({'X': X, 'T': T, 'Y0': Y0, 'Y1': Y1, 'Y': Y, 'ITE': ITE})
```

**å…³é”®ç‚¹**ï¼š
- éšæœºåˆ†é…ï¼š`np.random.binomial(1, 0.5, n)`
- è§‚æµ‹åˆ‡æ¢å…¬å¼ï¼š`Y = T * Y1 + (1 - T) * Y0`
</details>

---

### é¢˜ç›® 2ï¼šè®¡ç®— ATEï¼ˆæœ´ç´ ä¼°è®¡ vs è°ƒæ•´ä¼°è®¡ï¼‰

> **é¢˜ç›®**ï¼šå®ç°ä¸¤ç§ ATE ä¼°è®¡æ–¹æ³•ï¼Œæ¯”è¾ƒæœ‰æ— æ··æ·†æ—¶çš„å·®å¼‚

<details>
<summary>ğŸ’¡ å‚è€ƒç­”æ¡ˆ</summary>

```python
def calculate_ate_naive(df):
    """æœ´ç´ ä¼°è®¡ï¼šç›´æ¥æ¯”è¾ƒä¸¤ç»„å‡å€¼"""
    return df[df['T']==1]['Y'].mean() - df[df['T']==0]['Y'].mean()

def calculate_ate_adjusted(df, confounders=['X']):
    """è°ƒæ•´ä¼°è®¡ï¼šæ§åˆ¶æ··æ·†å˜é‡"""
    from sklearn.linear_model import LinearRegression
    features = ['T'] + confounders
    model = LinearRegression()
    model.fit(df[features], df['Y'])
    return model.coef_[0]  # T çš„ç³»æ•°å°±æ˜¯è°ƒæ•´åçš„ ATE
```

**å…³é”®ç‚¹**ï¼š
- æœ´ç´ ä¼°è®¡åœ¨éšæœºåŒ–ä¸‹æ— å
- æœ‰æ··æ·†æ—¶å¿…é¡»ç”¨è°ƒæ•´ä¼°è®¡
</details>

---

### é¢˜ç›® 3ï¼šè®¡ç®—æ··æ·†åå·® (OVB)

> **é¢˜ç›®**ï¼šå®ç° OVB å…¬å¼ Bias = Î³ Ã— Î´ çš„è®¡ç®—

<details>
<summary>ğŸ’¡ å‚è€ƒç­”æ¡ˆ</summary>

```python
def calculate_ovb(df, confound_var='X'):
    """
    è®¡ç®—é—æ¼å˜é‡åå·®
    Bias = Î³ Ã— Î´
    """
    from sklearn.linear_model import LinearRegression

    # Î³: X å¯¹ Y çš„æ•ˆåº”ï¼ˆæ§åˆ¶ Tï¼‰
    model_full = LinearRegression()
    model_full.fit(df[['T', confound_var]], df['Y'])
    gamma = model_full.coef_[1]  # X çš„ç³»æ•°

    # Î´: X ä¸ T çš„å…³è”ï¼ˆT å¯¹ X å›å½’ï¼‰
    model_delta = LinearRegression()
    model_delta.fit(df[[confound_var]], df['T'])
    delta = model_delta.coef_[0]

    # ç†è®ºåå·®
    bias = gamma * delta

    # éªŒè¯ï¼šå®é™…åå·®
    naive_ate = df[df['T']==1]['Y'].mean() - df[df['T']==0]['Y'].mean()
    adjusted_ate = model_full.coef_[0]
    actual_bias = naive_ate - adjusted_ate

    return {'gamma': gamma, 'delta': delta, 'theoretical_bias': bias, 'actual_bias': actual_bias}
```

**å…³é”®ç‚¹**ï¼š
- Î³ å’Œ Î´ åŒå· â†’ æ­£åå·®ï¼ˆé«˜ä¼°ï¼‰
- Î³ å’Œ Î´ å¼‚å· â†’ è´Ÿåå·®ï¼ˆä½ä¼°ï¼‰
</details>

---

### é¢˜ç›® 4ï¼šDID åŒé‡å·®åˆ†ä¼°è®¡

> **é¢˜ç›®**ï¼šå®ç°åŒé‡å·®åˆ†ä¼°è®¡é‡

<details>
<summary>ğŸ’¡ å‚è€ƒç­”æ¡ˆ</summary>

```python
def estimate_did(df, outcome='Y', treated_col='treated', post_col='post'):
    """
    DID ä¼°è®¡
    Ï„ = (Y_treat_post - Y_treat_pre) - (Y_control_post - Y_control_pre)
    """
    # å››ä¸ªç»„çš„å‡å€¼
    treat_post = df[(df[treated_col]) & (df[post_col])][outcome].mean()
    treat_pre = df[(df[treated_col]) & (~df[post_col])][outcome].mean()
    control_post = df[(~df[treated_col]) & (df[post_col])][outcome].mean()
    control_pre = df[(~df[treated_col]) & (~df[post_col])][outcome].mean()

    # DID ä¼°è®¡é‡
    did = (treat_post - treat_pre) - (control_post - control_pre)
    return did
```

**å…³é”®å‡è®¾**ï¼šå¹³è¡Œè¶‹åŠ¿å‡è®¾
</details>

---

### é¢˜ç›® 5ï¼šè¯†åˆ« DAG ä¸­çš„èŠ‚ç‚¹ç»“æ„

> **é¢˜ç›®**ï¼šç»™å®š DAG çš„è¾¹åˆ—è¡¨ï¼Œè¯†åˆ«æ¯ä¸ªèŠ‚ç‚¹æ˜¯æ··æ·†/ä¸­ä»‹/ç¢°æ’

<details>
<summary>ğŸ’¡ å‚è€ƒç­”æ¡ˆ</summary>

```python
def identify_structure(edges, node):
    """
    è¯†åˆ«èŠ‚ç‚¹çš„å› æœç»“æ„ç±»å‹
    - confounder: å‡ºåº¦ >= 2 (å‰å­ä¸­å¿ƒ)
    - mediator: å…¥åº¦ >= 1 ä¸” å‡ºåº¦ >= 1 (é“¾æ¡ä¸­é—´)
    - collider: å…¥åº¦ >= 2 ä¸” å‡ºåº¦ = 0 (ç¢°æ’ç‚¹)
    """
    in_degree = sum(1 for e in edges if e[1] == node)
    out_degree = sum(1 for e in edges if e[0] == node)

    if in_degree >= 2 and out_degree == 0:
        return "collider"
    elif out_degree >= 2:
        return "confounder"
    elif in_degree >= 1 and out_degree >= 1:
        return "mediator"
    return "other"

# æµ‹è¯•
edges = [("X", "T"), ("X", "Y"), ("T", "Y")]
print(identify_structure(edges, "X"))  # confounder
```

**è®°å¿†å£è¯€**ï¼š
- æ··æ·†ï¼ˆå‰å­ï¼‰ï¼šæŒ‡å‡ºå»å¤š
- ç¢°æ’ï¼šæŒ‡è¿›æ¥å¤šï¼Œä¸å‡ºå»
- ä¸­ä»‹ï¼šæœ‰è¿›æœ‰å‡º
</details>

---

### é¢˜ç›® 6ï¼šæ£€éªŒåå˜é‡å¹³è¡¡

> **é¢˜ç›®**ï¼šå®ç°åå˜é‡å¹³è¡¡æ£€éªŒï¼ˆç”¨äºéªŒè¯éšæœºåŒ–ï¼‰

<details>
<summary>ğŸ’¡ å‚è€ƒç­”æ¡ˆ</summary>

```python
def check_balance(df, treatment_col='T', covariates=None):
    """æ£€éªŒå¤„ç†ç»„å’Œå¯¹ç…§ç»„çš„åå˜é‡æ˜¯å¦å¹³è¡¡"""
    from scipy import stats

    results = []
    for cov in covariates:
        treated = df[df[treatment_col]==1][cov]
        control = df[df[treatment_col]==0][cov]

        # æ ‡å‡†åŒ–å‡å€¼å·®å¼‚ (SMD)
        pooled_std = np.sqrt((treated.var() + control.var()) / 2)
        smd = (treated.mean() - control.mean()) / pooled_std

        # t æ£€éªŒ
        _, p_value = stats.ttest_ind(treated, control)

        results.append({
            'variable': cov,
            'SMD': smd,
            'p_value': p_value,
            'balanced': abs(smd) < 0.1  # SMD < 0.1 è®¤ä¸ºå¹³è¡¡
        })

    return pd.DataFrame(results)
```

**åˆ¤æ–­æ ‡å‡†**ï¼š
- SMD < 0.1ï¼šè‰¯å¥½
- SMD < 0.25ï¼šå¯æ¥å—
- SMD â‰¥ 0.25ï¼šä¸¥é‡ä¸å¹³è¡¡
</details>

---

### é¢˜ç›® 7ï¼šæ¨¡æ‹Ÿ Simpson's Paradox

> **é¢˜ç›®**ï¼šç”Ÿæˆæ•°æ®å±•ç¤ºæ•´ä½“è¶‹åŠ¿å’Œåˆ†å±‚è¶‹åŠ¿ç›¸å

<details>
<summary>ğŸ’¡ å‚è€ƒç­”æ¡ˆ</summary>

```python
def create_simpson_paradox(n=500, seed=42):
    """
    Simpson's Paradox ç¤ºä¾‹
    æ•´ä½“çœ‹ç”¨è¯æœ‰å®³ï¼Œåˆ†å±‚çœ‹æ¯ç»„éƒ½æœ‰ç›Š
    """
    np.random.seed(seed)
    data = []

    # åŒ»é™¢ Aï¼ˆé‡ç—‡ä¸ºä¸»ï¼Œç”¨è¯å¤šï¼‰
    for _ in range(int(n * 1.6)):  # ç”¨è¯ç»„
        data.append({'åŒ»é™¢': 'A', 'ç”¨è¯': 1, 'åº·å¤': np.random.binomial(1, 0.50)})
    for _ in range(int(n * 0.4)):  # æœªç”¨è¯ç»„
        data.append({'åŒ»é™¢': 'A', 'ç”¨è¯': 0, 'åº·å¤': np.random.binomial(1, 0.30)})

    # åŒ»é™¢ Bï¼ˆè½»ç—‡ä¸ºä¸»ï¼Œç”¨è¯å°‘ï¼‰
    for _ in range(int(n * 0.4)):
        data.append({'åŒ»é™¢': 'B', 'ç”¨è¯': 1, 'åº·å¤': np.random.binomial(1, 0.90)})
    for _ in range(int(n * 1.6)):
        data.append({'åŒ»é™¢': 'B', 'ç”¨è¯': 0, 'åº·å¤': np.random.binomial(1, 0.70)})

    df = pd.DataFrame(data)

    # æ•´ä½“æ•ˆåº”ï¼ˆè´Ÿï¼çœ‹èµ·æ¥æœ‰å®³ï¼‰
    overall = df[df['ç”¨è¯']==1]['åº·å¤'].mean() - df[df['ç”¨è¯']==0]['åº·å¤'].mean()

    # åˆ†å±‚æ•ˆåº”ï¼ˆéƒ½æ˜¯æ­£ï¼å®é™…æœ‰ç›Šï¼‰
    df_A = df[df['åŒ»é™¢']=='A']
    effect_A = df_A[df_A['ç”¨è¯']==1]['åº·å¤'].mean() - df_A[df_A['ç”¨è¯']==0]['åº·å¤'].mean()

    return df, overall, effect_A
```

**æœ¬è´¨**ï¼šåŒ»é™¢ï¼ˆç—…æƒ…ï¼‰æ˜¯æ··æ·†å˜é‡
</details>

---

### é¢˜ç›® 8ï¼šæ•æ„Ÿæ€§åˆ†æ

> **é¢˜ç›®**ï¼šè¯„ä¼°ä¼°è®¡å¯¹æœªè§‚æµ‹æ··æ·†çš„ç¨³å¥æ€§

<details>
<summary>ğŸ’¡ å‚è€ƒç­”æ¡ˆ</summary>

```python
def sensitivity_analysis(current_estimate, gamma_range=None, delta_range=None):
    """
    æ•æ„Ÿæ€§åˆ†æï¼šå¦‚æœå­˜åœ¨æœªè§‚æµ‹æ··æ·† Uï¼Œæ•ˆåº”ä¼šå¦‚ä½•å˜åŒ–ï¼Ÿ
    çœŸå®æ•ˆåº” = å½“å‰ä¼°è®¡ - Î³_U Ã— Î´_U
    """
    if gamma_range is None:
        gamma_range = np.linspace(-2, 2, 9)
    if delta_range is None:
        delta_range = np.linspace(-1, 1, 9)

    results = []
    for gamma in gamma_range:
        for delta in delta_range:
            possible_bias = gamma * delta
            possible_true = current_estimate - possible_bias
            results.append({
                'gamma_U': gamma,
                'delta_U': delta,
                'possible_bias': possible_bias,
                'possible_true_effect': possible_true
            })

    return pd.DataFrame(results)
```

**è§£è¯»**ï¼šæ‰¾åˆ°ä½¿ç»“è®ºç¿»è½¬çš„ä¸´ç•Œå€¼ï¼Œåˆ¤æ–­æ˜¯å¦åˆç†
</details>

---

## é«˜é¢‘æ¦‚å¿µé¢˜

### Q1: ä»€ä¹ˆæ˜¯æ½œåœ¨ç»“æœæ¡†æ¶ï¼Ÿ

<details>
<summary>ğŸ’¡ ç­”æ¡ˆ</summary>

**æ ¸å¿ƒæ€æƒ³**ï¼š
- æ¯ä¸ªä¸ªä½“æœ‰ä¸¤ä¸ªæ½œåœ¨ç»“æœ Y(1) å’Œ Y(0)
- åªèƒ½è§‚æµ‹åˆ°ä¸€ä¸ªï¼Œå¦ä¸€ä¸ªæ˜¯åäº‹å®
- å› æœæ•ˆåº” = Y(1) - Y(0)

**ä¸å›å½’çš„åŒºåˆ«**ï¼š
- å›å½’å…³æ³¨é¢„æµ‹ E[Y|X]
- å› æœæ¨æ–­å…³æ³¨å¹²é¢„ E[Y(1) - Y(0)]

**ä¾‹å­**ï¼šåƒè¯ vs ä¸åƒè¯çš„ä¸¤ä¸ªå¹³è¡Œå®‡å®™
</details>

---

### Q2: ä¸ºä»€ä¹ˆ RCT èƒ½è¯†åˆ«å› æœæ•ˆåº”ï¼Ÿ

<details>
<summary>ğŸ’¡ ç­”æ¡ˆ</summary>

**æ ¸å¿ƒåŸå› **ï¼šéšæœºåŒ–ä½¿ $T \perp\!\!\!\perp \{Y(0), Y(1)\}$

**æ¨å¯¼**ï¼š
$$E[Y|T=1] - E[Y|T=0] = E[Y(1)] - E[Y(0)] = ATE$$

**ç›´è§‚ç†è§£**ï¼šéšæœºåŒ–è®©ä¸¤ç»„åœ¨æ‰€æœ‰ç‰¹å¾ä¸Š"å¹³å‡"ç›¸åŒï¼Œå”¯ä¸€åŒºåˆ«æ˜¯æ˜¯å¦æ¥å—å¤„ç†
</details>

---

### Q3: ATEã€ATTã€ATC çš„åŒºåˆ«ï¼Ÿ

<details>
<summary>ğŸ’¡ ç­”æ¡ˆ</summary>

| æ¦‚å¿µ | å…¬å¼ | å«ä¹‰ |
|-----|------|------|
| ATE | $E[Y(1)-Y(0)]$ | æ€»ä½“å¹³å‡æ•ˆåº” |
| ATT | $E[Y(1)-Y(0)\|T=1]$ | å¤„ç†ç»„çš„æ•ˆåº” |
| ATC | $E[Y(1)-Y(0)\|T=0]$ | å¯¹ç…§ç»„çš„æ•ˆåº” |

**ä½•æ—¶ç›¸ç­‰**ï¼šéšæœºåŒ–ä¸‹ ATE = ATT = ATC

**å®è·µé€‰æ‹©**ï¼š
- æ”¿ç­–è¯„ä¼° â†’ ATT
- æ¨å¹¿å†³ç­– â†’ ATE
</details>

---

### Q4: è§£é‡Š OVB å…¬å¼ Bias = Î³ Ã— Î´

<details>
<summary>ğŸ’¡ ç­”æ¡ˆ</summary>

- **Î³**ï¼šé—æ¼å˜é‡ X å¯¹ Y çš„æ•ˆåº”
- **Î´**ï¼šé—æ¼å˜é‡ X ä¸ T çš„å…³è”

**åå·®ä¸ºé›¶çš„æ¡ä»¶**ï¼š
1. Î³ = 0ï¼šX ä¸å½±å“ Y
2. Î´ = 0ï¼šX ä¸ T æ— å…³

**åå·®æ–¹å‘**ï¼š
- Î³ > 0, Î´ > 0 â†’ æ­£åå·®ï¼ˆé«˜ä¼°ï¼‰
- Î³ > 0, Î´ < 0 â†’ è´Ÿåå·®ï¼ˆä½ä¼°ï¼‰
</details>

---

### Q5: ä¸‰ç§ DAG ç»“æ„çš„æ§åˆ¶è§„åˆ™ï¼Ÿ

<details>
<summary>ğŸ’¡ ç­”æ¡ˆ</summary>

| ç»“æ„ | å›¾ç¤º | æ§åˆ¶ä¸­é—´èŠ‚ç‚¹å | è§„åˆ™ |
|-----|------|--------------|------|
| Forkï¼ˆæ··æ·†ï¼‰| T â† X â†’ Y | é˜»æ–­ | **å¿…é¡»æ§åˆ¶** |
| Chainï¼ˆä¸­ä»‹ï¼‰| T â†’ M â†’ Y | é˜»æ–­ | ä¼°è®¡æ€»æ•ˆåº”æ—¶**ä¸æ§åˆ¶** |
| Colliderï¼ˆç¢°æ’ï¼‰| T â†’ C â† Y | æ‰“å¼€ï¼ | **ç»å¯¹ä¸æ§åˆ¶** |

**è®°å¿†**ï¼šç¢°æ’é»˜è®¤å…³é—­ï¼Œæ§åˆ¶åæ‰“å¼€ï¼ˆåç›´è§‰ï¼ï¼‰
</details>

---

### Q6: ä»€ä¹ˆæ˜¯åé—¨å‡†åˆ™ï¼Ÿ

<details>
<summary>ğŸ’¡ ç­”æ¡ˆ</summary>

å˜é‡é›†åˆ Z æ»¡è¶³åé—¨å‡†åˆ™ï¼Œéœ€æ»¡è¶³ï¼š
1. Z é˜»æ–­æ‰€æœ‰ä» T åˆ° Y çš„åé—¨è·¯å¾„
2. Z ä¸åŒ…å« T çš„ä»»ä½•åä»£

**ä½œç”¨**ï¼šå‘Šè¯‰æˆ‘ä»¬"åº”è¯¥æ§åˆ¶å“ªäº›å˜é‡"

**ä¾‹å­**ï¼š
```
DAG: X â†’ T, X â†’ Y, T â†’ Y
åé—¨è·¯å¾„: T â† X â†’ Y
è°ƒæ•´é›†: {X} âœ“
```
</details>

---

### Q7: Simpson's Paradox çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ

<details>
<summary>ğŸ’¡ ç­”æ¡ˆ</summary>

**ç°è±¡**ï¼šæ•´ä½“è¶‹åŠ¿å’Œåˆ†å±‚è¶‹åŠ¿ç›¸å

**æœ¬è´¨**ï¼šå­˜åœ¨æ··æ·†å˜é‡

**ç»å…¸æ¡ˆä¾‹**ï¼š
- ä¼¯å…‹åˆ©å½•å–ï¼ˆé™¢ç³»æ˜¯æ··æ·†ï¼‰
- ç”¨è¯æ•ˆæœï¼ˆç—…æƒ…ä¸¥é‡ç¨‹åº¦æ˜¯æ··æ·†ï¼‰

**å¯ç¤º**ï¼šä¸æ˜¯æ‚–è®ºï¼Œæ˜¯æ··æ·†åå·®çš„è¡¨ç°
</details>

---

### Q8: è¯†åˆ«ç­–ç•¥çš„é€‰æ‹©é¡ºåºï¼Ÿ

<details>
<summary>ğŸ’¡ ç­”æ¡ˆ</summary>

```
æœ‰éšæœºå®éªŒï¼Ÿ â†’ RCTï¼ˆç®€å•å‡å€¼å·®ï¼‰
    â†“å¦
æœ‰æ—¶é—´æ–­ç‚¹ï¼Ÿ â†’ DIDï¼ˆåŒé‡å·®åˆ†ï¼‰
    â†“å¦
æœ‰åˆ†é…é˜ˆå€¼ï¼Ÿ â†’ RDDï¼ˆæ–­ç‚¹å›å½’ï¼‰
    â†“å¦
æœ‰å·¥å…·å˜é‡ï¼Ÿ â†’ IVï¼ˆä¸¤é˜¶æ®µæœ€å°äºŒä¹˜ï¼‰
    â†“å¦
èƒ½æµ‹é‡æ··æ·†ï¼Ÿ â†’ PSM/IPWï¼ˆæ¡ä»¶ç‹¬ç«‹æ–¹æ³•ï¼‰
    â†“å¦
æ— æ³•å¯é è¯†åˆ« â†’ éœ€è¦æ›´å¤šæ•°æ®æˆ–å®éªŒè®¾è®¡
```
</details>

---

## æ˜“é”™ç‚¹è­¦ç¤º

### 1. ç¢°æ’åå·®é™·é˜±
âŒ **é”™è¯¯**ï¼šæ§åˆ¶æ‰€æœ‰å˜é‡æ€»æ˜¯å¯¹çš„
âœ… **æ­£ç¡®**ï¼šç¢°æ’å˜é‡ä¸èƒ½æ§åˆ¶ï¼Œå¦åˆ™ä¼šåˆ›é€ è™šå‡å…³è”

### 2. æ··æ·† vs ä¸­ä»‹
âŒ **é”™è¯¯**ï¼šæŠŠä¸­ä»‹å˜é‡å½“æ··æ·†æ§åˆ¶
âœ… **æ­£ç¡®**ï¼šä¸­ä»‹æ˜¯å› æœè·¯å¾„çš„ä¸€éƒ¨åˆ†ï¼Œä¼°è®¡æ€»æ•ˆåº”æ—¶ä¸æ§åˆ¶

### 3. ç›¸å…³ â‰  å› æœ
âŒ **é”™è¯¯**ï¼šå†°æ·‡æ·‹é”€é‡å’Œæººæ°´ç›¸å…³ â†’ å†°æ·‡æ·‹å¯¼è‡´æººæ°´
âœ… **æ­£ç¡®**ï¼šæ¸©åº¦æ˜¯æ··æ·†å˜é‡

### 4. ITE ä¸å¯è§‚æµ‹
âŒ **é”™è¯¯**ï¼šä¸ªä½“æ•ˆåº”å¯ä»¥ç›´æ¥è®¡ç®—
âœ… **æ­£ç¡®**ï¼šITE = Y(1) - Y(0)ï¼Œä½†åŒä¸€ä¸ªä½“åªèƒ½è§‚æµ‹ä¸€ä¸ª

### 5. ATT â‰  ATE
âŒ **é”™è¯¯**ï¼šå¤„ç†ç»„çš„æ•ˆæœå°±æ˜¯æ€»ä½“æ•ˆæœ
âœ… **æ­£ç¡®**ï¼šæœ‰å¼‚è´¨æ€§æ—¶ ATT â‰  ATE

---

## å¿«é€Ÿè®°å¿†å¡ç‰‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å› æœæ¨æ–­æ ¸å¿ƒé—®é¢˜                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚  åŒä¸€ä¸ªä½“æ— æ³•åŒæ—¶è§‚æµ‹ Y(1) å’Œ Y(0)               â”‚
â”‚  â†’ åäº‹å®ä¸å¯è§‚æµ‹                               â”‚
â”‚  â†’ éœ€è¦å‡è®¾æ¥è¯†åˆ«å› æœæ•ˆåº”                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  éšæœºåŒ–çš„å¨åŠ›                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚  T âŠ¥ {Y(0), Y(1)}                              â”‚
â”‚  â†’ å¤„ç†ç»„å’Œå¯¹ç…§ç»„åœ¨æ‰€æœ‰ç‰¹å¾ä¸Šå¹³å‡ç›¸åŒ            â”‚
â”‚  â†’ ç®€å•å‡å€¼å·® = çœŸå®å› æœæ•ˆåº”                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ··æ·†åå·® OVB                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚  Bias = Î³ Ã— Î´                                   â”‚
â”‚  Î³: Xâ†’Y çš„æ•ˆåº”                                  â”‚
â”‚  Î´: X å’Œ T çš„å…³è”                               â”‚
â”‚  â†’ åŒå·é«˜ä¼°ï¼Œå¼‚å·ä½ä¼°                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸‰ç§ç»“æ„æ§åˆ¶è§„åˆ™                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚  Fork (æ··æ·†):    T â† X â†’ Y  â†’ å¿…é¡»æ§åˆ¶ X        â”‚
â”‚  Chain (ä¸­ä»‹):   T â†’ M â†’ Y  â†’ é€šå¸¸ä¸æ§åˆ¶ M      â”‚
â”‚  Collider (ç¢°æ’): T â†’ C â† Y  â†’ ç»å¯¹ä¸æ§åˆ¶ C     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

> **æœ€åæé†’**ï¼šé¢è¯•æ—¶å…ˆç”»å› æœå›¾ï¼Œå†å†³å®šæ–¹æ³•ï¼
